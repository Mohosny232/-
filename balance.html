<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Balance Page</title>
  <style> 
    body {
  margin: 0;
  padding: 20px;
  font-family: Arial, sans-serif;
  background: #fff;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
}

.container {
  width: 100%;
  max-width: 360px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* اسم المستخدم */
.user-label {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 15px;
  margin-bottom: 10px;
  font-weight: bold;
  font-size: 24px;
  color: #222;
}

.user-avatar {
  width: 40px;
  height: 40px;
  background-color: #0070ba;
  color: white;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 20px;
}

/* خانة الإدخال */
.input-wrapper {
  width: 100%;
  position: relative;
  margin-bottom: 20px;
}

input[type="number"] {
  width: 100%;
  padding: 12px 50px 12px 12px;
  font-size: 20px;
  border-radius: 12px;
  border: 1px solid #ccc;
  box-sizing: border-box;
}

.currency-label {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  font-weight: bold;
  color: #0070bacc;
  font-size: 18px;
}

#submitBtn {
  width: 100%;
  padding: 14px;
  background-color: #0070ba66;
  border: none;
  border-radius: 25px;
  color: white;
  font-size: 20px;
  font-weight: bold;
  cursor: not-allowed;
  transition: background-color 0.3s ease;
}

#submitBtn.active {
  background-color: #003d82;
  cursor: pointer;
}

/* التحويلات */
.log-container {
  margin-top: 30px;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 15px;
  align-items: center;
}

.transaction-item {
  display: flex;
  justify-content: space-between;
  width: 100%;
  max-width: 320px;
  padding: 10px 15px;
  background: #f9f9f9;
  border-radius: 12px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  font-weight: bold;
  align-items: center;
}

.transaction-left {
  display: flex;
  align-items: center;
  gap: 10px;
}

.transaction-avatar {
  width: 36px;
  height: 36px;
  background: #0070ba;
  color: white;
  font-size: 18px;
  font-weight: bold;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.transaction-right {
  display: flex;
  align-items: center;
  gap: 5px;
}

.transaction-amount {
  color: red;
  font-weight: bold;
  font-size: 18px;
}

.transaction-currency {
  color: black;
  font-size: 16px;
}
#resetBtn {
  position: fixed;
  bottom: 10px;
  left: 10px;
  background-color: transparent;
  color: #888;
  border: none;
  font-size: 14px;
  cursor: pointer;
  opacity: 0.3;
  z-index: 999;
}
.toast {
  position: fixed;
  top: -80px; /* مخفي فوق الشاشة */
  left: 50%;
  transform: translateX(-50%);
  background-color: #fff; /* خلفية بيضاء */
  color: #000; /* خط أسود */
  padding: 15px 25px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  font-weight: 600;
  font-size: 16px;
  font-family: Arial, sans-serif;
  transition: top 0.5s ease, opacity 0.5s ease;
  opacity: 0;
  z-index: 9999;
  pointer-events: none;
  user-select: none;
}

.toast.show {
  top: 20px;    /* ينزل من فوق */
  opacity: 1;
  pointer-events: auto;
  }
#resetBtn:hover {
  opacity: 1;
}
  </style>
</head>
<body>

<div class="container">
  <!-- اسم المستخدم + الأفتار -->
  <div class="user-label">
    <div id="usernameDisplay">Username</div>
    <div id="userAvatar" class="user-avatar">U</div>
  </div>

  <!-- خانة إدخال المبلغ -->
  <div class="input-wrapper">
    <input type="number" id="balanceInput" placeholder="Enter amount" min="0" step="0.01" />
    <div class="currency-label">EUR</div>
  </div>
<div id="toast" class="toast">Notification Text</div>
  <!-- زر التحويل -->
  <button id="submitBtn" disabled>EUR 0.00</button>

  <!-- التحويلات تظهر هنا -->
  <div id="transactionLog" class="log-container"></div>
</div> 
<button id="resetBtn" title="Reset Transactions">H</button>
  <script>
    // استلام اسم المستخدم من localStorage (مثلاً من صفحة send.html)
    const username = localStorage.getItem('selectedUsername') || "Username";

    // عرض الاسم وأول حرف للـ avatar
    const usernameDisplay = document.getElementById('usernameDisplay');
    const userAvatar = document.getElementById('userAvatar');
    usernameDisplay.textContent = username;
    userAvatar.textContent = username.charAt(0).toUpperCase();

    // تحكم في الزر والنص داخل الزر حسب قيمة الإدخال
    
  const balanceInput = document.getElementById('balanceInput');
  const submitBtn = document.getElementById('submitBtn');

  function updateButton() {
    const val = parseFloat(balanceInput.value);
    if (!isNaN(val) && val > 0) {
      submitBtn.classList.add('active');
      submitBtn.disabled = false;
      submitBtn.textContent = `EUR ${val.toFixed(2)}`;
      submitBtn.style.backgroundColor = "#003d82";
      submitBtn.style.color = "white";
      submitBtn.style.cursor = "pointer";
    } else {
      submitBtn.classList.remove('active');
      submitBtn.disabled = true;
      submitBtn.textContent = "EUR 0.00";
      submitBtn.style.backgroundColor = "#0070ba66";
      submitBtn.style.color = "white";
      submitBtn.style.cursor = "default";
    }
  }

  balanceInput.addEventListener('input', updateButton);

  window.addEventListener('pageshow', () => {
    updateButton();
  });

  // باقي الكود مثل التعامل مع الضغط على الزر ...

    const logContainer = document.getElementById('transactionLog');

// جلب البيانات المحفوظة من localStorage عند فتح الصفحة
const savedTransactions = JSON.parse(localStorage.getItem('transactions') || "[]");

// عرض العمليات المحفوظة عند تحميل الصفحة
savedTransactions.forEach(t => {
  renderTransaction(t.username, parseFloat(t.amount));
});

function renderTransaction(username, amount) {
  const div = document.createElement('div');
  div.className = 'transaction-item';
  div.innerHTML = `
    <div class="transaction-left">
      <div class="transaction-avatar">${username.charAt(0).toUpperCase()}</div>
      <div>${username}</div>
    </div>
    <div class="transaction-right">
      <span class="transaction-amount">${amount.toFixed(2)}</span>
      <span class="transaction-currency">EUR</span>
    </div>
  `;
  // نضيفه أول القائمة
  logContainer.prepend(div);
}

submitBtn.addEventListener('click', () => {
  if (!submitBtn.disabled) {
    const amount = parseFloat(balanceInput.value);
    
    // نجيب اسم المستخدم من localStorage
    const usernameFromSend = localStorage.getItem('selectedUsername') || "Username";

    const transaction = {
      username: usernameFromSend,
      amount
    };

    // حفظ في localStorage
    const updatedList = [transaction, ...savedTransactions];
    localStorage.setItem('transactions', JSON.stringify(updatedList));

    // عرض في الواجهة
    renderTransaction(usernameFromSend, amount);

    // زر Loading
    submitBtn.textContent = "Loading...";
    submitBtn.style.backgroundColor = "#0070ba66";
    submitBtn.style.color = "white";
    submitBtn.style.cursor = "default";
    submitBtn.disabled = true;

    setTimeout(() => {
      // الإشعار
      const toast = document.getElementById('toast');
      const sound = document.getElementById('notificationSound');

      toast.textContent = `The amount ${amount.toFixed(2)} EUR has been sent to ${usernameFromSend}`;
      toast.classList.add('show');

      // تشغيل صوت التنبيه
      sound.currentTime = 0;
      sound.play();

      // بعد ثانيتين نخفي الإشعار ونتحول للصفحة التالية
      setTimeout(() => {
        toast.classList.remove('show');
        window.location.href = "theend.html";
      }, 2000);
    }, 2000);
  }
});
    const resetBtn = document.getElementById('resetBtn');

resetBtn.addEventListener('click', () => {
  if (confirm("Are you sure you want to clear all transactions?")) {
    localStorage.removeItem('transactions');
    logContainer.innerHTML = ""; // مسح من الواجهة
  }
});
    // Reset زر المبلغ لحالته الأصلية بعد العودة للصفحة
window.addEventListener('load', () => {
  submitBtn.textContent = "EUR 0.00";
  submitBtn.classList.remove('active');
  submitBtn.disabled = true;
  balanceInput.value = "";
});
  </script>
</body>
</html>
